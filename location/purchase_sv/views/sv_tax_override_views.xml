<?xml version="1.0" encoding="utf-8"?>
<odoo>
  
  <!-- LIST dedicado -->
  <record id="sv_tax_override_wizard_line_list" model="ir.ui.view">
    <field name="name">sv.tax.override.wizard.line.list</field>
    <field name="model">sv.tax.override.wizard.line</field>
    <field name="arch" type="xml">
      <list editable="bottom" create="false" delete="false" string="Impuestos">
        <field name="tax_id" readonly="1"
              options="{'no_open': True, 'no_create': True, 'no_create_edit': True}"/>
        <field name="current_account_id" readonly="1"
              options="{'no_open': True, 'no_create': True, 'no_create_edit': True}"/>
        <field name="new_account_id" required="1"
              options="{'no_create_edit': True}"/>
      </list>
    </field>
  </record>

  <!-- Form del wizard -->
  <record id="view_sv_tax_override_wizard" model="ir.ui.view">
    <field name="name">sv.tax.override.wizard.form</field>
    <field name="model">sv.tax.override.wizard</field>
    <field name="arch" type="xml">
      <form string="Cambiar cuentas de impuestos">
        <group>
          <field name="move_id" invisible="1"/>
          <!-- Fuerza a usar tu vista LIST; pon ambos por compatibilidad -->
          <field name="line_ids"
                context="{
                  'list_view_ref': 'purchase_sv.sv_tax_override_wizard_line_list',
                  'tree_view_ref': 'purchase_sv.sv_tax_override_wizard_line_list'
                }"/>
        </group>
        <footer>
          <button string="Aplicar" type="object" name="action_apply"
                  context="{'force_save': 1}" class="btn-primary"/>
          <button string="Cancelar" special="cancel" class="btn-secondary"/>
        </footer>
      </form>
    </field>
  </record>


  <!-- La acción SÍ puede llevar active_id para el padre -->
  <record id="action_sv_tax_override_wizard" model="ir.actions.act_window">
    <field name="name">Cambiar cuentas de impuestos</field>
    <field name="res_model">sv.tax.override.wizard</field>
    <field name="view_mode">form</field>
    <field name="target">new</field>
    <field name="context">{'default_move_id': active_id}</field>
  </record>


</odoo>

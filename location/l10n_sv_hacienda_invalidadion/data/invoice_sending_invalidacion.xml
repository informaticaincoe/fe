<odoo>
    <data noupdate="0">
        <record id="invoice_sending_invalidacion" model="mail.template">
            <field name="name">Invoice: Sending Invalidation</field>
            <field name="model_id" ref="account.model_account_move"/>
            <field name="subject">[Documento Invalidado] {{ object.company_id.name }} Invoice (Ref {{ object.name or 'n/a' }})</field>
            <field name="body_html"><![CDATA[
<p><b>Este correo corresponde a una INVALIDACIÓN</b></p>

<!-- Contenido del body idéntico a la plantilla normal -->
<p>
Estimado {{ object.partner_id.name if not object.partner_id.parent_id else object.partner_id.name + ' (' + object.partner_id.parent_id.name + ')' }},
<br/><br/>
Adjunto encontrará su {{ object.name if object.name else 'Factura' }}
{{ '(' + object.invoice_origin + ')' if object.invoice_origin else '' }}
por <span style="font-weight:bold;">{{ format_amount(object.amount_total, object.currency_id) }}</span>
de {{ object.company_id.name }}.
<br/>
{{ 'Esta Factura se encuentra Pagada.' if object.payment_state in ('paid', 'in_payment') else
   'Por favor remita el pago a su pronta conveniencia.' }}
{% if object.payment_reference %}
    <br/><br/>
    Por favor utilice la siguiente comunicación para su pago:
    <span style="font-weight:bold;">{{ object.payment_reference }}</span>
{% endif %}
<br/><br/>
Contáctenos si tiene alguna duda.
<br/><br/>
{{ object.invoice_user_id.signature if object.invoice_user_id.signature else '--<br/>SIT Admin' }}
</p>
]]></field>

            <!-- Usamos exactamente el mismo remitente que la plantilla normal -->
            <field name="email_from">{{ user.email_formatted }}</field>

            <!-- Usamos exactamente el mismo destinatario que la plantilla normal -->
            <field name="partner_to">{{ object.partner_id.id }}</field>

            <field name="lang">{{ object.partner_id.lang }}</field>
            <field name="auto_delete" eval="True"/>
        </record>
    </data>
</odoo>
